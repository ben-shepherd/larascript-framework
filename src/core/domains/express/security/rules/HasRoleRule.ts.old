
import AbstractSecurityRule from "../../abstract/AbstractSecurityRule";
import { SecurityEnum } from "../../enums/SecurityEnum";
import HasRoleMiddleware from "../middleware-deprecated/HasRoleMiddleware";

class HasRoleRule extends AbstractSecurityRule {

    constructor(roles: string | string[]) {
        super({
            id: SecurityEnum.HAS_ROLE,
            also: SecurityEnum.AUTHORIZED,
            when: null,
            never: null,
            middleware: HasRoleMiddleware.toExpressMiddleware(roles)
        });
    }

}

export default HasRoleRule;