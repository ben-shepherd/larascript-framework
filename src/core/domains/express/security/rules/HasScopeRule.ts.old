import AbstractSecurityRule from "../../abstract/AbstractSecurityRule";
import { SecurityEnum } from "../../enums/SecurityEnum";
import HasScopeMiddleware from "../middleware-deprecated/HasScopeMiddleware";

class EnableScopeRule extends AbstractSecurityRule {

    constructor(scopesExactMatch: string | string[] = [], scopesPartialMatch: string | string[] = []) {
        super({
            id: SecurityEnum.HAS_SCOPE,
            when: null,
            never: null,
            middleware: HasScopeMiddleware.toExpressMiddleware(scopesExactMatch, scopesPartialMatch)
        });
    }

}

export default EnableScopeRule;