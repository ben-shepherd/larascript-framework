import AbstractSecurityRule from "../../abstract/AbstractSecurityRule";
import { SecurityEnum } from "../../enums/SecurityEnum";
import RateLimitedMiddleware from "../middleware-deprecated/RateLimitedMiddleware";

class RateLimitedRule extends AbstractSecurityRule {

    constructor(limit: number = 100, perMinuteAmount: number = 60) {
        super({
            id: SecurityEnum.RATE_LIMITED,
            when: null,
            never: null,
            middleware: RateLimitedMiddleware.toExpressMiddleware(limit, perMinuteAmount)
        });
    }

}

export default RateLimitedRule;